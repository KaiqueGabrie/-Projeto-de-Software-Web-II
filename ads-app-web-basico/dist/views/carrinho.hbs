<section class="layout_padding">
<section class="cart_section layout_padding">
  <div class="container">
    <div class="heading_container heading_center">
      <h2>Seu Carrinho üõí</h2>
      <p>Revise seus doces antes de finalizar o pedido ‚ú®</p>
    </div>

    <div id="cart-empty" class="text-center">
      <h5>Seu carrinho est√° vazio.</h5>
      <a href="/menu" class="btn btn-primary mt-3">Ver Card√°pio</a>
    </div>

    <div id="cart-table-wrapper" style="display:none;">
      <div class="table-responsive">
        <table class="table table-bordered text-center table-striped">
          <thead>
            <tr>
              <th>Produto</th>
              <th>Qtd</th>
              <th>Pre√ßo</th>
              <th>Subtotal</th>
              <th>A√ß√£o</th>
            </tr>
          </thead>
          <tbody id="cart-items"></tbody>
        </table>
      </div>

      <h4 class="text-right">
        Total: <span id="cart-total">R$ 0,00</span>
      </h4>

      <div class="checkout_box mt-4">
        <h5>Dados para entrega üç∞</h5>

        <input id="client-name" class="form-control mb-2" placeholder="Seu nome *">
        <input id="client-street" class="form-control mb-2" placeholder="Rua *">
        <input id="client-number" class="form-control mb-2" placeholder="N√∫mero *">
        <input id="client-neighborhood" class="form-control mb-2" placeholder="Bairro *">
        <input id="client-cep" class="form-control mb-3" placeholder="CEP (opcional)">

        <h5 class="mt-4">Pagamento üí≥</h5>

        <select id="payment-method" class="form-control mb-2" required>
          <option value="" disabled selected>Selecione a forma de pagamento</option>
          <option value="Pix">PIX</option>
          <option value="Cr√©dito">Cart√£o de Cr√©dito</option>
          <option value="D√©bito">Cart√£o de D√©bito</option>
          <option value="Dinheiro">Dinheiro</option>
        </select>

        <div id="change-wrapper" class="mb-3" style="display:none;">
          <input id="client-change" type="number"
            class="form-control"
            placeholder="Troco para quanto? (ex: 50)">
        </div>


        <button id="btn-whatsapp" class="btn btn-success btn-lg btn-block">
          Finalizar pedido via WhatsApp üí¨
        </button>
      </div>
    </div>

  </div>
</section>


<script>
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const tbody = document.getElementById("cart-body");

  tbody.innerHTML = cart.map(item => `
    <tr>
      <td>${item.name}</td>
      <td>${item.qty}</td>
      <td>R$ ${item.price.toFixed(2)}</td>
      <td>R$ ${(item.qty * item.price).toFixed(2)}</td>
    </tr>
  `).join("");

  document.getElementById("finalizar").addEventListener("click", () => {
    const msg = cart.map(
      item => `${item.qty}x ${item.name} - R$ ${(item.qty * item.price).toFixed(2)}`
    ).join("\n");

    const url = `https://wa.me/556992020634?text=Pedido%20Encanto%20Rosa%20Doceria:%0A${encodeURIComponent(msg)}`;
    window.open(url, "_blank");
  });
</script>
